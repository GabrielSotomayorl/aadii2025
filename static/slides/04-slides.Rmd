---
title: "An√°lisis de datos estad√≠sticos en R"
author: "Valentina Andrade"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    self_contained: true
    lib_dir: "libs"
    chakra: "libs/remark-latest.min.js"
    css: ["default", "css/ath-slides.css", "css/ath-inferno-fonts.css", "css/animate.css"]
    seal: false
    includes:
      after_body: "html/insert-logo.html"
    anchor_sections: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      beforeInit: "libs/macros.js"
      navigation:
        scroll: false
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, 
                      fig.retina = 3, fig.align = "center")
```

```{r packages-data, include=FALSE}
pacman::p_load(tidyverse, sjPlot, ggsci, wordcloud2)
theme_set(theme_sjplot2())
```

```{r xaringanExtra, echo=FALSE}
xaringanExtra::use_xaringan_extra(c("tile_view", "animate_css", "share_again", "scribble", "frezeeframe", "editable"))
```

```{r xaringanExtra-clipboard, echo=FALSE}
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clipboard\">Copiar c√≥digo</i>",
    success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\">¬°Listo!</i>",
    error_text = "<i class=\"fa fa-times-circle\" style=\"color: #F94144\"></i>"
  ),
  rmarkdown::html_dependency_font_awesome()
)
```


class: center middle main-title section-title-1 top-logo

.small[
# An√°lisis de regresi√≥n lineal m√∫ltiple
]

.class-info[
<br>
**Sesi√≥n N¬∞ 4**<br>
**An√°lisis Avanzado de Datos II**
<br>

.pull-right.small[
**Profesor** Gabriel Sotomayor L√≥pez <br>
.tiny[Universidad Diego Portales<br>
]
]

]

---
class: title title-inv-1

# Objetivos de la sesi√≥n

- Introducir el an√°lisis de regresi√≥n lineal simple y m√∫ltiple 

- Revisar la ejecuci√≥n de modelos de regresi√≥n en R 

---
class: title title-inv-1

# Contenidos Sesi√≥n N¬∞4

.box-3.medium.sp-after-half[**Introducci√≥n a regresi√≥n lineal**]

.box-4.medium.sp-after-half[**Regresi√≥n lineal m√∫ltiple**]

.box-1.medium.sp-after-half[**Supuestos del modelo de regresi√≥n**]


---

class: center middle main-title section-title-3 top-logo

# Introducci√≥n a regresi√≥n lineal

---

class: title title-3

# Varianza

.small[**Varianza:** es el promedio de las distancias de los casos al promedio, tomando en cuenta los signos (eleva al cuadrado todas las distancias al promediarlas)]

.center[![:scale 20%](https://www.calculadoraconversor.com/wp-content/uploads/2016/11/formula-varianza-muestral.png)]

.small[**Desviaci√≥n est√°ndar:** Es la ra√≠z cuadrada de la varianza. Es la que mejor da cuenta de la dispersi√≥n (es decir de las distancias de los casos al promedio]

.center[![:scale 30%](https://revistachilenadeanestesia.cl/img/Rev%20Chil%20Anest%202014;%2043%20116-121.xml_image14.jpg)]

---

class: title title-3

# Covarianza

.sma[La covarianza da cuenta del a variaci√≥n conjunta de dos variables respecto de sus medias.  
Puede tomar valores positivos, dando cuenta de una relaci√≥n directa (por ejemplo a mayor educaci√≥n, mayores ingresos) o valores negativos, dando cuenta de una relaci√≥n inversa (por ejemplo a menores horas de trabajo, mayor satisfacci√≥n con la vida).]
.center[![:scale 50%](https://economipedia.com/wp-content/uploads/2017/10/F%C3%B3rmula-de-la-Covarianza-tama%C3%B1o-extenso.jpg)]

---

class: title title-3

# Correlaci√≥n

La correlaci√≥n (correlaci√≥n de Pearson) corresponde a un valor estandarizado de la covarianza que puede tomar valores ente -1 y 1.
  

.center[![:scale 55%](https://www.questionpro.com/blog/wp-content/uploads/2019/07/analisis-de-correlacion-2-450x122.jpg)]
.center[![:scale 20%](https://economipedia.com/wp-content/uploads/2015/12/formula-correlaci%C3%B3n.png)]

---

class: title title-3

# Correlaci√≥n

.center[![:scale 75%](https://raw.githubusercontent.com/Clases-GabrielSotomayor/pruebapagina/master/static/slides/img/03/corr.png)]

---

class: title title-3

# Regresi√≥n lineal

.small[La regresi√≥n lineal es una t√©cnica de an√°lisis estad√≠stico que nos permite estimar los efectos de ciertas variables (independientes o predictores) en una variable cuantitativa (dependiente o predicha).  

Nos permite conocer la variaci√≥n de una variable dependiente respecto a la variaci√≥n de una o m√°s variables independientes. Esto nos puede permitir predecir el valor que asume la variable dependiente √° partir del valor de las independientes.   

Al igual que las pruebas estad√≠stica bivariadas revisadas en la clases pasadas, nos permite hacer inferencia estad√≠stica, es decir, determinar si las relaciones observadas en el modelo de regresi√≥n son estad√≠sticamente significativas.]

---

class: title title-3

# Recta de regresi√≥n

La covariaci√≥n de Y respecto de X puede expresarse a partir de una recta. 

.center[ùëå=ùõº+ùõΩùëã]

  
.small[ùëå =  Valor estimado de la variable dependiente  
ùõº = El intercepto (valor que asume Y cuando X es 0)  
ùõΩ = el coeficiente de regresi√≥n o pendiente es decir, el efecto en Y de un aumento de 1 en X   
X = la variable independiente.]

---

class: title title-3

# .small[Estimaci√≥n de m√≠nimos cuadrados ordinarios]
.center[![:scale 62%](https://raw.githubusercontent.com/Clases-GabrielSotomayor/pruebapagina/master/static/slides/img/03/mco.png)]

.tiny[Para estimar dicha recta se utiliza la estimaci√≥n de m√≠nimos cuadrados ordinarios (Ordinary Least Squares OLS). Esta busca minimizar al suma de los residuos al cuadrado, siendo estos √∫ltimos la diferencia entre los valores predichos por el modelo (la recta) y cada valor observado.]

---

class: title title-3

# Coeficientes de la ecuaci√≥n  

Constante o intercepto 
Valor esperado de Y cuando la variable independiente tiene el valor 0

.center[![:scale 30%](https://raw.githubusercontent.com/Clases-GabrielSotomayor/pruebapagina/master/static/slides/img/03/B0.jpg)]


Coeficiente de regresi√≥n (Œ≤)
Cambio en Y por cada aumento en una unidad de X, indica la relaci√≥n entre X e Y

.center[![:scale 30%](https://raw.githubusercontent.com/Clases-GabrielSotomayor/pruebapagina/master/static/slides/img/03/B1.jpg)]
---

class: title title-3

# Coeficiente de determinaci√≥n R2

Estad√≠stico de ajuste que describe la proporci√≥n de la varianza de Y que se relaciona con las variables independientes del modelo.

.center[![:scale 50%](https://raw.githubusercontent.com/Clases-GabrielSotomayor/pruebapagina/master/static/slides/img/03/R2.jpg)]
---

class: center middle main-title section-title-4 top-logo

# Regresi√≥n lineal m√∫ltiple

---

class: title title-4

# Regresi√≥n lineal m√∫ltiple

Corresponde a una extensi√≥n del modelo de regresi√≥n lineal donde agregamos m√°s variables independientes.

.center[![:scale 50%](https://raw.githubusercontent.com/Clases-GabrielSotomayor/pruebapagina/master/static/slides/img/03/rlm.jpg)]

.center[![:scale 50%](https://raw.githubusercontent.com/Clases-GabrielSotomayor/pruebapagina/master/static/slides/img/03/rlm2.jpg)]
---

class: title title-4

# Regresi√≥n lineal m√∫ltiple

.small[**Constante o intercepto**   
Valor esperado de Y cuando las variables independientes tienen valor 0

**Coeficiente de regresi√≥n (Œ≤)**  
Cambio en Y por cada aumento en una unidad de X, controlando por las dem√°s variables en el modelo. Indica la relaci√≥n parcial entre X e Y

**Coeficiente de determinaci√≥n R2 **  
Igual interpretaci√≥n que en el modelo de regresi√≥n simple
Describe la proporci√≥n en la varianza de Y que es explicada por el modelo de regresi√≥n (en este caso, por todas las variables incluidas)]

---

class: title title-4

# Control estad√≠stico

En una regresi√≥n lineal m√∫ltiple buscamos dar cuenta de la relaci√≥n entre una variable x1 sobre y considerando adem√°s el efecto de x2 sobre y.  
As√≠, podemos estimar el efecto, por ejemplo, de la edad en los ingresos independiente de la educaci√≥n, es decir, manteniendo esta √∫ltima constante (controlando por).  
Cuando no existe relaci√≥n entre los predictores, la inclusi√≥n de otras variables no afecta el valor de los coeficientes de regresi√≥n. 

---

class: title title-4

# Inferencia en los coeficientes de regresi√≥n

Igual que en el caso de la regresi√≥n lineal, pero evaluando si una variable tiene un efecto significativo una vez que controlamos por las dem√°s variables en el modelo:

H0: ùõΩùëó=0, controlando por las dem√°s variables
H1: ùõΩùëó‚â†0, controlando por las dem√°s variables

Distribuci√≥n muestral t con n-(k+1) grados de libertad

Donde 
n= tama√±o de la muestra
k= n√∫mero de variables independientes en el modelo

---

class: center middle main-title section-title-1 top-logo

# Supuestos del modelo de regresi√≥n

---

class: title title-1

# Ausencia de casos at√≠picos

Corresponden a observaciones individuales que no siguen el patr√≥n de relaci√≥n de los dem√°s casos. Es decir, son casos que el modelo predice menos bien que a los dem√°s casos.  
- Estos casos pueden influenciar resultados, en particular si la muestra es chica. 
- Se recomienda correr el modelo excluyendo casos at√≠picos para ver si cambian los estad√≠sticos (pendiente y constante). 


---

class: title title-1

# Relaci√≥n lineal
- Y y X se relacionan por medio de una ecuaci√≥n lineal (gr√°ficamente, la relaci√≥n forma una recta).
- Si la relaci√≥n es aproximadamente lineal, tiene sentido usar modelos de regresi√≥n lineal.
- Se puede evaluar en base a diagramas de dispersi√≥n (si el n es peque√±o)
- Una correlaci√≥n alta entre las variables es indicaci√≥n de que la relaci√≥n es lineal.
- Si la relaci√≥n no es lineal, considerar utilizar otro tipo de regresi√≥n o transformar variables (por ejemplo, ver efectos de variables al cuadrado).

---

class: title title-1

# .tiny[Ausencia de multicolinealidad entre las variables dependientes]  
.small[Cuando dos o m√°s variables independientes est√°n altamente correlacionadas. 
- En estas situaciones resulta dif√≠cil estimar cu√°l de las dos variables es la que explica la variable dependiente, generando errores est√°ndar altos y baja precisi√≥n de los coeficientes calculados. 
- Para identificar esta situaci√≥n, hay que revisar la matriz de correlaci√≥n entre las variables y detectar correlaciones de 0,8 o m√°s. Si este es el caso, es recomendable eliminar una de las dos variables del modelo.]

---

class: title title-1

# .tiny[Ausencia de multicolinealidad entre las variables dependientes]  
.small[
- Tambi√©n existen estad√≠sticos que miden la presencia de multicolinealidad al correr el an√°lisis de regresi√≥n. En particular: 
- **Factor de inflaci√≥n de la varianza, VIF**: indicador de cu√°nto aumenta el error est√°ndar debido a problemas de multicolinealidad.
- Sacamos la ra√≠z cuadrada e interpretamos el valor resultante como en cuantas veces mayor es el error est√°ndar debido a problemas de multicolinealidad. Por ejemplo, un VIF de 4 significa que el error est√°ndar es 2 veces mayor de lo que ser√≠a si las variables no estuvieran correlacionadas.
- Un VIF mayor a 2.5 es considerado como indicando problemas de multicolinealidad.]

---

class: title title-1

# Homocedasticidad de los errores

Los residuos tienen una varianza constante a lo largo de los distintos valores de Y  

- Residuos: diferencia entre el valor estimado por el modelo y el valor observado que tiene un caso en la muestra  
- Esto quiere decir que el modelo es igualmente apropiado para predecir valores bajos (por ejemplo, bajos ingresos) y altos de la variable dependiente (por ejemplo, altos ingresos).  
- El contrario es heterocedasticidad  
**Soluci√≥n: Modelos con errores est√°ndares robustos**

---

class: title title-1

# .small[Normalidad en la distribuci√≥n de los residuos]

Los residuos en torno a los valores estimados de Y se distribuyen normalmente.
- Si los residuos se distribuyen normalmente, quiere decir que la mayor parte de los residuos se encuentran en torno a 0 (es decir, son valores que se alejan poco del valor observado). 
- A su vez, son cada vez menos los residuos a medida que estos valores son mayores en t√©rminos absolutos.


---
class: center middle main-title section-title-1 top-logo

.small[
# An√°lisis de regresi√≥n lineal m√∫ltiple
]

.class-info[
<br>
**Sesi√≥n N¬∞ 4**<br>
**An√°lisis Avanzado de Datos II**
<br>

.pull-right.small[
**Profesor** Gabriel Sotomayor L√≥pez <br>
.tiny[Universidad Diego Portales<br>
]
]

]
